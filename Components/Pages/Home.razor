@page "/"

@attribute [StreamRendering]

@inject IJokeService _jokeService

<FluentStack Orientation="Orientation.Vertical" HorizontalAlignment="HorizontalAlignment.Center">

    <FluentLabel>Welcome to Onerdy's Dad Jokes website!</FluentLabel>
    <br />

    @if (randomJoke == null)
    {
        <FluentProgressRing />
        <FluentLabel>Loading jokes...</FluentLabel>
    }

    else
    {
        <FluentCard Width="300px" Height="200px">
            <FluentLabel Typo="Typography.Body" Weight="FontWeight.Bold">@randomJoke?.Question</FluentLabel>
                <br />
                <FluentLabel Typo="Typography.Body">@randomJoke?.Answer </FluentLabel>
        </FluentCard>
@*         <FluentButton OnClick="@LoadRandomJoke">Load Next Joke (Broken)</FluentButton> *@
    }
</FluentStack>

@code {
    private IEnumerable<Joke>? jokes;
    private Joke? randomJoke;

    protected override async Task OnInitializedAsync()
    {
        jokes = await _jokeService.GetAllJokes();
        LoadRandomJoke();
    }

    private void LoadRandomJoke()
    {
        Random rnd = new Random();

        randomJoke = jokes?.ElementAt<Joke>(rnd.Next(0, jokes.Count()));

    }
}
